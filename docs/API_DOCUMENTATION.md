# Deep Research API Documentation

## Overview

The Deep Research API provides enterprise-grade AI research capabilities for prediction markets. It offers sentiment analysis, risk assessment, confidence scoring, and comprehensive market intelligence.

## Base URL

```
https://your-convex-deployment.convex.cloud/api/v1/research
```

## Authentication

All API requests require an API key in the Authorization header:

```
Authorization: Bearer <your-api-key>
```

**Note**: API key management is currently in development. For now, any non-empty key will be accepted. Production implementation will include proper key validation and rate limiting.

## Endpoints

### POST /api/v1/research

Perform deep research analysis on a prediction market.

#### Request

**Headers:**
```
Authorization: Bearer <your-api-key>
Content-Type: application/json
```

**Body:**
```json
{
  "market_id": "string (required)",
  "analysis_depth": "standard" | "deep" (optional, default: "standard")
}
```

**Example:**
```bash
curl -X POST https://your-convex-deployment.convex.cloud/api/v1/research \
  -H "Authorization: Bearer your-api-key" \
  -H "Content-Type: application/json" \
  -d '{
    "market_id": "0x1234...",
    "analysis_depth": "deep"
  }'
```

#### Response

**Success (200):**
```json
{
  "success": true,
  "research": {
    "market_id": "0x1234...",
    "market_title": "Will X happen by Y date?",
    "summary": "Comprehensive analysis summary...",
    "sentiment": {
      "overall": "positive" | "negative" | "neutral",
      "score": -1.0 to 1.0,
      "breakdown": {
        "news": -1.0 to 1.0,
        "social": -1.0 to 1.0,
        "market": -1.0 to 1.0
      },
      "confidence": 0.0 to 1.0
    },
    "risk": {
      "overall": "low" | "medium" | "high",
      "score": 0.0 to 1.0,
      "factors": [
        {
          "name": "Volatility",
          "level": "low" | "medium" | "high",
          "description": "Risk factor description"
        }
      ],
      "confidence": 0.0 to 1.0
    },
    "confidence": {
      "overall": 0.0 to 1.0,
      "breakdown": {
        "marketMatch": 0.0 to 1.0,
        "dataQuality": 0.0 to 1.0,
        "sourceDiversity": 0.0 to 1.0,
        "recency": 0.0 to 1.0
      }
    },
    "insights": [
      "Key insight 1",
      "Key insight 2",
      "Key insight 3"
    ],
    "sources": {
      "markets": 0,
      "news": 0,
      "social": 0,
      "trends": 0
    },
    "timestamp": 1234567890
  }
}
```

**Error (400):**
```json
{
  "success": false,
  "error": "market_id is required"
}
```

**Error (401):**
```json
{
  "success": false,
  "error": "API key required. Include 'Authorization: Bearer <your-api-key>' header."
}
```

**Error (500):**
```json
{
  "success": false,
  "error": "Error message"
}
```

## Response Fields

### Sentiment

- **overall**: Overall sentiment classification
- **score**: Sentiment score from -1.0 (very negative) to 1.0 (very positive)
- **breakdown**: Sentiment by source type
  - **news**: News article sentiment
  - **social**: Social media sentiment
  - **market**: Market-based sentiment (from probability)
- **confidence**: Confidence in sentiment analysis (0.0 to 1.0)

### Risk

- **overall**: Overall risk level
- **score**: Risk score from 0.0 (low risk) to 1.0 (high risk)
- **factors**: Array of identified risk factors
  - **name**: Risk factor name (e.g., "Volatility", "Liquidity")
  - **level**: Risk level for this factor
  - **description**: Explanation of the risk factor
- **confidence**: Confidence in risk assessment (0.0 to 1.0)

### Confidence

- **overall**: Overall confidence in the research (0.0 to 1.0)
- **breakdown**: Confidence by component
  - **marketMatch**: How well markets match the query (0.0 to 1.0)
  - **dataQuality**: Quality of available data (0.0 to 1.0)
  - **sourceDiversity**: Diversity of data sources (0.0 to 1.0)
  - **recency**: Recency of the data (0.0 to 1.0)

### Insights

Array of 3-5 key insights generated by AI analysis.

### Sources

Count of data sources used:
- **markets**: Number of markets analyzed
- **news**: Number of news articles
- **social**: Number of social media posts
- **trends**: Number of Google Trends data points

## Analysis Depth

- **standard**: Faster analysis with standard depth
- **deep**: More comprehensive analysis with deeper data retrieval

## Rate Limiting

Rate limiting will be implemented in production. Current limits:
- TBD (to be determined)

## Error Handling

All errors return a JSON response with:
- `success`: `false`
- `error`: Error message

Common error codes:
- `400`: Bad Request (missing or invalid parameters)
- `401`: Unauthorized (missing or invalid API key)
- `404`: Not Found (market not found)
- `500`: Internal Server Error

## CORS

The API supports CORS for browser-based requests. Include appropriate headers in your requests.

## Example Usage

### JavaScript/TypeScript

```typescript
async function getMarketResearch(marketId: string) {
  const response = await fetch('https://your-convex-deployment.convex.cloud/api/v1/research', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer your-api-key',
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      market_id: marketId,
      analysis_depth: 'deep',
    }),
  });

  const data = await response.json();
  return data;
}
```

### Python

```python
import requests

def get_market_research(market_id: str):
    response = requests.post(
        'https://your-convex-deployment.convex.cloud/api/v1/research',
        headers={
            'Authorization': 'Bearer your-api-key',
            'Content-Type': 'application/json',
        },
        json={
            'market_id': market_id,
            'analysis_depth': 'deep',
        }
    )
    return response.json()
```

## Future Enhancements

- API key management dashboard
- Rate limiting and quotas
- Webhook support
- Batch requests
- Historical analysis
- Custom analysis parameters
- SDK generation

## Support

For API support, please contact the development team or open an issue on GitHub.
